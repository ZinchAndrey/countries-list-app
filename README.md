# countries-list-app

Ознакомиться с проектом можно по ссылке - https://countries-list-vue-app.web.app


## Список вопросов

1. **Фильтрация**  
  Выбранное значение региона я выношу во Vuex, чтобы проще было общаться компонентам.  
  По такой же логике я работаю со строкой поиска. То есть при инпуте в строку поиска, я записываю текущее значение строки поиска во Vuex и на ее основании также фильтрую  
  1.2 В целом норм ли такая концепция в части поиска?  
  1.3 Корректно ли я ее использую в CountrySearch.vue ? Смущает то, что там у меня и v-model, и @input

---

2. **Список свойств**  
  На странице с детальной информацией внутри списка `.country__description-list` я очень банально действую - создаю элементы списка без какой-либо автоматизации.Корректно ли это?
  Циклом тут не получится насколько я понимаю, так как важен порядок и нужны не все свойства страны.
  Еще как вариант сделать мини-компонент, в который можно будет передавать название свойства и значение, но мне кажется это усложнение в данном случае.
  Подскажи, я корректно рассуждаю?

---

3. **Ссылка на главную**  
  В header-е есть ссылка на главную страницу.
  Как сделать так, чтобы не перезагружалась страница с новым запросом на сервер, а как бы назад переход был без запроса на сервер, ведь возможно уже в сторе есть все необходимые данные. Как при клике кнопки "back", например.  
  Понятное дело, что через `this.$router.back()` нельзя действовать, так как мы можем не с главное страницы попасть на страницу с детальной информацией о стране.

---

4. **Темная тема**  
  Впервые делал подобное) Корректна ли моя концепция, что мы на `body` вешаем класс определенный в зависимости от того, какая тема, а также в зависимости от этого определяем значения переменных с цветами фонов и шрифтов?
  Храню значение текущей темы я в `store`

---

5. **Сохранение поля ввода**  
  Чтобы сохранять значение инпутов фильтра и поиска при переходе назад (со страницы страны), я обернул компонент `<country-header>` в `<keep-alive>`, но это не помогло, поле поиска все равно пустое при переходе назад, а листинг стран отображается так, как будто поле не пустое. Подскажи, как с этим быть?

---

6. **Получение детальной информации о стране**  
  Вопрос по странице `CountryDetail.vue`
  При обновлении страницы у нас пустой `store` и соответственно нет данных по стране. Их надо получить.
  И вот тут я немножко запутался с тем, как правильно концептуально это делать.
  В итоге я сделал так, чтобы просто работало, в надежде, что ты поправишь меня.
  Сейчас я просто внутри компонента страницы `CountryDetail.vue` проверяю, есть ли в `store` массив `countries` и если нет, вызываю action с фетчом по загрузке данных обо ВСЕХ странах (эта функция на главной тоже вызывается и я ее просто переиспользую).
  Корректно ли это?\*
  Кажется, что все же правильнее загружать информацию только о конкретной стране, на странице которой мы находимся.
  Но если так, возникает ряд вопросов:  
  6.1. Где я должен использовать `fetch` - непосредственно внутри компонента или внутри `store`?  
  6.2. Где я должен хранить данные о стране - внутри компонента или в `store`?
  Не могу понять как концептуально правильнее...

---

7. **Относительные адреса при деплое**  
  Так как GitHub Pages содержит в строке адреса название репозитория, то чтобы роутер работал корректно, я использую `vue.config.js`, в котором прописываю нужный путь, а также в настройках роутера (`routes.js`) использую название репозитория в качестве параметра метода `createWebHistory()`  
  Так вот я заметил, что на GitHub Pages при переходе по ссылке в хедере сайта ( http://joxi.ru/l2ZWxPECl4zRyA ) формируется некорректная ссылка - https://zinchandrey.github.io/countries вместо https://zinchandrey.github.io/countries-list-app/countries  
  Подскажи пожалуйста, почему так происходит?  
  При этом при работе на локальном сервере все нормально и редирект происходит корректно.

  ----

8. **Бонусный вопрос**  
  В продолжение вопроса о маршрутизации
  Изначально я приложил ссылку на демку - https://zinchandrey.github.io/countries-list-app/countries - и она выдает 404  
  При этом если зайти на https://zinchandrey.github.io/countries-list-app/ - то все норм, и в итоге произойдет редирект на https://zinchandrey.github.io/countries-list-app/countries , которая изначально была 404... Не понимаю, как это работает.



-----
## Ответы Александра 
Комментарий от учителя
Приветствую! Пройдемся во вопросам)

1. Фильтрация
1.2 В целом норм ли такая концепция в части поиска? - да, это нормально. Часто вы вообще сможете обойтись без vuex (у нас даже на больших проектов его мало), но просто нам надо научиться с ним взаимодействовтать.
1.3 А вот вместо v-model и @input можно (и нужно) юзать геттеры и сеттеры https://stackoverflow.com/questions/54928111/should-we-use-v-model-to-modify-vuex-store

2. Список свойств
То что вы сделали - это нормально. Не надо мудрить там, где не надо)) Единственное, чтобы избежать ошибок, я бы поставил на выведенных полях v-if. Чтобы если, например, с сервера не пришел capital для страны - ничего не поломалось

3. Ссылка на главную
Как вариант, вы можете обратиться в хуке created к state, который хранит в себе список стран. Если там что-то есть - не грузить страны и использовать ту информацию, что есть во vuex)

4. Темная тема
Я бы просто хранил значение в localStorage и все, не используя Vuex. Он тут не сильно нужен) Ну а в остальном логика правильная, я бы тоже так сделал)

5. Сохранение поля ввода
Как вариант, попробуйте в keep-alive обернуть не только <country-header>, но и еще те компоненты, что внутри лежат. То есть не только родитель должен быть обернут, но и внутренние компоненты, которым надо задать сохранение состояния

6. Получение детальной информации о стране
https://restcountries.com/#api-endpoints-v3-name - посмотри на это эндпойнт (сама дока - https://restcountries.com/ ). Надо брать запрос к единственной стране) То есть делай проверку: если есть список стран во vuex - бери инфу оттуда. Иначе обращайся к определенной стране

7-8. Деплой
GH Pages не очень хороший вариант для деплоя SPA. Поизучай Heroku или Netlify (второй мне нравится больше). Там нет такого геморроя, если не ошибаюсь, со всякими редиректами)

На счет все остального - молодец) Все очень хорошо. По факту все моменты, которые я бы отписал как замечания - ты сам спросил)



--------
## Список вопросов 2  

1.3 Речь о файле `CountrySearch.vue ` 
Подкорректировал, теперь событие `@input` на поле поиска вызывает сеттер, который меняет значение внутри `store`.
При этом, чтобы было двустороннее связывание, значение `:value` данного поля я связываю с вычисляемым значением `searchTerm()`, которое с помощью геттера берет значение из `store`.  
То есть теперь все взаимодействие через vuex.  
Правда ощущение, что из-за этого все стало медленнее работать, как будто инпутлаг. Не знаю как объяснить, как будто бы вычисляемое свойство `searchTerm()`, завязанное на vuex не сразу уведомляется, что внутри стора произошло изменение. Особенно заметно это, когда стираешь введенное значение, на последних 2х буквах.  
https://gyazo.com/5c816ae2a6b91b56e6aae1fa017a90fb  
На видео я зажал backspace.

Посмотри пожалуйста - нет ли у меня ошибки?   

2. Добавил проверку на наличие свойств и также добавил проверку на наличие пограничных стран.

3. У меня уже была эта проверка (1) + я дополнительно в хуке добавил (2) - все равно не помогло - http://joxi.ru/DrlJBZRHKPRjl2  
Возможно это такое поведение браузера, я не знаю, но начинается перезагрузка страницы и внутри стора нет ничего в хуке `created()`.

4. Понял.  

5. Проблема ушла, как только от `v-model` ушел в поле поиска и все через vuex.

6. Добавил функционал проверки наличия стран внутри `state`, и если их нет, обращаюсь на сервер за данными о конкретной стране. Внутри `state` завел для этого отдельное свойство.

7. Понял, задеплоил на firebase - https://countries-list-vue-app.web.app  
Роутинг стал работать нормально